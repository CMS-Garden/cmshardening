<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>BSICMS2/hardening-scripts/python: Required packages</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BSICMS2/hardening-scripts/python
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Required packages </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h2>Debian</h2>
<ul>
<li>*<code>python-yaml</code>* resp. *<code>python3-yaml</code>* depending on which version of python you are using*</li>
<li>*<code>python-netifaces</code>* resp. *<code>python3-netifaces</code>* depending on which version of python you are using*</li>
<li>*<code>python-six</code>* resp. *<code>python3-six</code>* depending on which version of python you are using*</li>
<li>*<code>python-lxml</code>* resp. *<code>python3-lxml</code>* depending on which version of python you are using*</li>
</ul>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ sudo apt-get install python python-yaml python-netifaces python-six</div></div><!-- fragment --><p>or</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ sudo apt-get install python3 python3-yaml python3-netifaces python3-six</div></div><!-- fragment --><h1>Recommended packages</h1>
<ul>
<li>*<code>coloredlogs</code>* for displaying colored logs on the console</li>
</ul>
<h1>Running this script</h1>
<p><code>cd</code> into directory <code>python</code> and run </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;$ sudo ./hardening.sh</div></div><!-- fragment --><h1>Configuration</h1>
<p>All configuration files use the <a href="https://en.wikipedia.org/wiki/YAML">YAML</a> syntax, with the following extensions:</p>
<ul>
<li>environment variables can be used</li>
<li>references (*) can refer to anchors (&amp;) in different files. All YAML files are merged before references are resolved by the YAML parser.</li>
</ul>
<p>The configuration of this toolset is separated into multiple files:</p>
<table class="doxtable">
<tr>
<th>Filename </th><th>Description  </th></tr>
<tr>
<td><code>config.yml</code> </td><td>Global Configuration file for the whole toolset </td></tr>
<tr>
<td><code>modules/</code>*<code>&lt;mycomponent&gt;</code>*<code>.yml</code> </td><td>Configuration file used for the component *<code>&lt;mycomponent&gt;</code>*. For example, the configuration for hardening sshd is stored in <code>modules/sshd.yml</code> </td></tr>
</table>
<h2>Global Configuration</h2>
<p>Example:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;Logging:</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;    LogLevel: DEBUG</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;    LogHandler: StreamHandler</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    Verbose: True</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;RunModules: [network, apache, sshd, php, WordPress, debian, java, python]</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Backup:</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  BaseDir: &quot;$HOME/hardening-backup&quot;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;HardeningSettings:   {</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    ssh-runtime-user: &amp;ssh-runtime-user         &quot;sshd&quot;,</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    ssh-runtime-group: &amp;ssh-runtime-group       &quot;ssh&quot;,</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    ssh-listening-port: &amp;ssh-listening-port     &quot;22&quot;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;}</div></div><!-- fragment --><table class="doxtable">
<tr>
<th>Setting</th><th>Description  </th></tr>
<tr>
<td><code>Logging/LogLevel</code></td><td>specifies how verbose the toolset shall be. Valid values (with increasing verbosity) are <code>CRITICAL</code>, <code>ERROR</code>, <code>WARNING</code>, <code>INFO</code>, <code>DEBUG</code> </td></tr>
<tr>
<td><code>Logging/LogHandler</code></td><td>Name of a class from package <code>logging.handlers</code>. Valid values are <code>StreamHandler</code>, <code>FileHandler</code> or <code>NullHandler</code> </td></tr>
<tr>
<td><code>RunModules</code></td><td>a list of modules which shall be run. Each entry in this list refers to a YAML file int the <code>modules</code> directory. </td></tr>
<tr>
<td><code>Backup/BaseDir</code></td><td>Name of the directory where backup files will be stored </td></tr>
<tr>
<td><code>HardeningSettings</code></td><td>Here, a lot of global settings can be specified, so that it is not necessary anymore to edit any YAML files. All settings here should be marked with an anchor (&amp;). </td></tr>
</table>
<h2>Hardening Modules</h2>
<p>The configuration of any module is divided into two parts:</p>
<ul>
<li><code>RunSections</code> contains a list of sections names. For each entry in this list there should be a <em>Section</em> in the next part of the module</li>
<li>Each <em>Section</em> is a associative array with the following content:<ul>
<li><code>RunUtils</code> contains a list of associative array, each of which names a class from the <code>utils</code> package and contains options. For every entry in list list, an instance of the specified class is being created, using the options specified</li>
<li><code>Options</code> is an associative array which contains options that have to be applied for every <code>RunUtils</code>-entry.</li>
</ul>
</li>
</ul>
<h2>Utils</h2>
<table class="doxtable">
<tr>
<th>util class</th><th>option </th><th>is required?</th><th>meaning  </th></tr>
<tr>
<td><code>apache.ApacheDismod</code></td><td></td><td></td><td>this module runs a2dismod to disable an apache module </td></tr>
<tr>
<td></td><td><code>modname</code> </td><td>True </td><td>name of the apache module to be disabled </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>apache.ApacheEnmod</code></td><td></td><td></td><td>this module runs a2enmod to enable an apache module </td></tr>
<tr>
<td></td><td><code>modname</code> </td><td>True </td><td>name of the apache module to be enabled </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>configfile.ApacheConfigEntry</code></td><td></td><td></td><td>ApacheConfigEntry is a specialized version of ConfigFileEntry which is able to find a specific section inside the config file and put the requested value into this section </td></tr>
<tr>
<td></td><td><code>transaction</code> </td><td>True </td><td>path of the apache config file </td></tr>
<tr>
<td></td><td><code>key</code> </td><td>True </td><td>name of the configuration setting </td></tr>
<tr>
<td></td><td><code>value</code> </td><td>True </td><td>value to be set for the configuration setting </td></tr>
<tr>
<td></td><td><code>section</code> </td><td>False </td><td>section inside the config file where setting must be placed in </td></tr>
<tr>
<td></td><td><code>listseparator</code> </td><td>False </td><td>if the value is a list then this options specifies how the distinct values must be separated </td></tr>
<tr>
<td></td><td><code>separator</code> </td><td>False </td><td>the string that divides setting name and setting value in the config file </td></tr>
<tr>
<td></td><td><code>commentchar</code> </td><td>False </td><td>all characters in a line after the comment character are ignored </td></tr>
<tr>
<td></td><td><code>multiple</code> </td><td>False </td><td>if this is set to true then existing settings with the same key and different value are not overwritten, but a new line is being inserted </td></tr>
<tr>
<td></td><td><code>before-key</code> </td><td>False </td><td>describes a key in the config file BEFORE which the current setting will be inserted. </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>configfile.ConfigFileEntry</code></td><td></td><td></td><td>searches through the given configuration file if there already exists a setting whose name matches that of the given key. If a matching entry is found, it is being updated. If no matching entry is found, the setting will be appended to the file. If the user has set <code>multiple</code> to <code>True</code>, than also the value will be used to find a matching value. This allows to add multiple settings with the same key, but different value, to a file. </td></tr>
<tr>
<td></td><td><code>transaction</code> </td><td>True </td><td>path of the config file </td></tr>
<tr>
<td></td><td><code>key</code> </td><td>True </td><td>name of the configuration setting </td></tr>
<tr>
<td></td><td><code>value</code> </td><td>True </td><td>value to be set for the configuration setting </td></tr>
<tr>
<td></td><td><code>separator</code> </td><td>False </td><td>the string that divides setting name and setting value in the config file </td></tr>
<tr>
<td></td><td><code>listseparator</code> </td><td>False </td><td>if the value is a list then this options specifies how the distinct values must be separated </td></tr>
<tr>
<td></td><td><code>commentchar</code> </td><td>False </td><td>all characters in a line after the comment character are ignored </td></tr>
<tr>
<td></td><td><code>multiple</code> </td><td>False </td><td>if this is set to true then existing settings with the same key and different value are not overwritten, but a new line is being inserted </td></tr>
<tr>
<td></td><td><code>before-key</code> </td><td>False </td><td>describes a key in the config file BEFORE which the current setting will be inserted. </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>configfile.IniFileEntry</code></td><td></td><td></td><td></td></tr>
<tr>
<td></td><td><code>transaction</code> </td><td>True </td><td>path of the apache config file </td></tr>
<tr>
<td></td><td><code>key</code> </td><td>True </td><td>name of the configuration setting </td></tr>
<tr>
<td></td><td><code>value</code> </td><td>True </td><td>value to be set for the configuration setting </td></tr>
<tr>
<td></td><td><code>section</code> </td><td>False </td><td>section inside the config file where setting must be placed in </td></tr>
<tr>
<td></td><td><code>listseparator</code> </td><td>False </td><td>if the value is a list then this options specifies how the distinct values must be separated </td></tr>
<tr>
<td></td><td><code>separator</code> </td><td>False </td><td>the string that divides setting name and setting value in the config file </td></tr>
<tr>
<td></td><td><code>commentchar</code> </td><td>False </td><td>all characters in a line after the comment character are ignored </td></tr>
<tr>
<td></td><td><code>multiple</code> </td><td>False </td><td>if this is set to true then existing settings with the same key and different value are not overwritten, but a new line is being inserted </td></tr>
<tr>
<td></td><td><code>before-key</code> </td><td>False </td><td>describes a key in the config file BEFORE which the current setting will be inserted. </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>filesystem.ChangeOwner</code></td><td></td><td></td><td>this class can be used to change the owner (and, if necessary, the owning group) of a file </td></tr>
<tr>
<td></td><td><code>user</code> </td><td>True </td><td>name of the new owner </td></tr>
<tr>
<td></td><td><code>group</code> </td><td>False </td><td>name of the owning group </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>filesystem.ChangePermissions</code></td><td></td><td></td><td>this class can be used to change the access permissions of a file. The mode must be a valid octal number between <code>000</code> and <code>777</code>. </td></tr>
<tr>
<td></td><td><code>mode</code> </td><td>True </td><td>mode to be used as new access permissions </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>filesystem.DeleteFile</code></td><td></td><td></td><td>this class can be used to delete a file from the filesystem. wildcards for filenames are currently not supported </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>filesystem.Directory</code></td><td></td><td></td><td>creates a directory </td></tr>
<tr>
<td></td><td><code>path</code> </td><td>True </td><td>complete path of the new directory </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>net.Firewall</code></td><td></td><td></td><td>creates a firewall rule. Be aware that the default policy for all chains is "DROP", which cannot be altered using configuration files </td></tr>
<tr>
<td></td><td><code>protocol</code> </td><td>True </td><td>name of the protocol. must be either <code>tcp</code>, <code>udp</code> or <code>icmp</code> </td></tr>
<tr>
<td></td><td><code>src</code> </td><td>False </td><td>name or ip address of the sending host </td></tr>
<tr>
<td></td><td><code>dst</code> </td><td>False </td><td>name of ip address of the receiving host </td></tr>
<tr>
<td></td><td><code>action</code> </td><td>False </td><td>specifies what shoud be done with matching packets. Default value is <code>ACCEPT</code> </td></tr>
<tr>
<td></td><td><code>chain</code> </td><td>False </td><td>name of the chain where the rule must be inserted. Should be <code>INPUT</code>, <code>OUTPUT</code> or <code>FORWARD</code> </td></tr>
<tr>
<td></td><td><code>srcport</code> </td><td>False </td><td>source port of the packet. Only valid for <code>tcp</code> and <code>udp</code> </td></tr>
<tr>
<td></td><td><code>dstport</code> </td><td>False </td><td>destination port of the packet. Only valid for <code>tcp</code> and <code>udp</code> </td></tr>
<tr>
<td></td><td><code>icmp-type</code> </td><td>False </td><td>ICMP type. Please run <code>iptables -p icmp -h</code> to see which values are supported on your system </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>net.StaticIP</code></td><td></td><td></td><td>uses the current network configuration, no matter if its being configured statically or dynamically, and writes a network configuration file, so that the current configuration is static from now on. No dhcp will be used afterwards </td></tr>
<tr>
<td></td><td><code>interface</code> </td><td>True </td><td>name of the interface to be configured </td></tr>
<tr>
<td></td><td><code>inet-address</code> </td><td>True </td><td>IPv4 network address </td></tr>
<tr>
<td></td><td><code>netmask</code> </td><td>False </td><td>subnet mask, defaults to 255.255.255.0 </td></tr>
<tr>
<td></td><td><code>gateway</code> </td><td>False </td><td>IPv4 address of the default gateay, if any </td></tr>
<tr>
<td></td><td><code>dns-nameservers</code> </td><td>False </td><td>IPv4 addresses of DNS name servers </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>os.CheckVersion</code></td><td></td><td></td><td>compares the version of an installed component with a version that is specified as parameter </td></tr>
<tr>
<td></td><td><code>key</code> </td><td>True </td><td>specifies which version you are interested in. must be one of <code>php</code>, <code>java</code> or <code>python</code> </td></tr>
<tr>
<td></td><td><code>version</code> </td><td>True </td><td>specifies a version with which the installed version should be compared </td></tr>
<tr>
<td></td><td><code>operation</code> </td><td>True </td><td>must be <code>greater_then</code> </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>os.ConfigureService</code></td><td></td><td></td><td>this class is used to enable, disable, start or stop a service </td></tr>
<tr>
<td></td><td><code>servicename</code> </td><td>True </td><td>unique name of the service </td></tr>
<tr>
<td></td><td><code>action</code> </td><td>True </td><td>specifies what must be done with the service. must be one of <code>enable</code>, <code>disable</code>, <code>start</code> or <code>stop</code> </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
<tr>
<td><code>os.UserItem</code></td><td></td><td></td><td>creates a user. If the user already exists, it will be modified. Be aware: this class does not use Transactions, so there is no rollback possible. </td></tr>
<tr>
<td></td><td><code>name</code> </td><td>True </td><td>name of the user to be created </td></tr>
<tr>
<td></td><td><code>home</code> </td><td>False </td><td>home directory </td></tr>
<tr>
<td></td><td><code>shell</code> </td><td>False </td><td>login shell </td></tr>
<tr>
<td></td><td><code>meta</code> </td><td>False </td><td>contains information about that specific hardening step </td></tr>
<tr>
<td></td><td><code>run-if</code> </td><td>False </td><td>specifies under which condition this util will be run </td></tr>
</table>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
